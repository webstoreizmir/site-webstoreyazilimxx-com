---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import HeroSection from '../components/HeroSection.astro';
import ServicesSection from '../components/ServicesSection.astro';
import AboutSection from '../components/AboutSection.astro';
import ProcessSection from '../components/ProcessSection.astro';
import TestimonialsSection from '../components/TestimonialsSection.astro';
import FAQSection from '../components/FAQSection.astro';
import ContactSection from '../components/ContactSection.astro';
import Footer from '../components/Footer.astro';

// JSON verisini al
import siteConfig from '../data/site-config.json';

// --- YEDEK Ä°Ã‡ERÄ°KLER ---
const DUMMY_SERVICES = [
  { title: "Web TasarÄ±m", description: "Modern ve mobil uyumlu web siteleri.", icon: "ðŸ’»" },
  { title: "Sosyal Medya", description: "MarkanÄ±zÄ± dijital dÃ¼nyada bÃ¼yÃ¼tÃ¼n.", icon: "ðŸ“±" },
  { title: "SEO Hizmeti", description: "Google'da Ã¼st sÄ±ralara Ã§Ä±kÄ±n.", icon: "ðŸš€" }
];

const DUMMY_PROCESS = [
  { step: "01", title: "KeÅŸif", description: "Ä°htiyaÃ§larÄ±nÄ±zÄ± analiz ediyoruz." },
  { step: "02", title: "TasarÄ±m", description: "Modern Ã§izgilerle tasarlÄ±yoruz." },
  { step: "03", title: "Teslimat", description: "OnayÄ±nÄ±zla yayÄ±na alÄ±yoruz." }
];

const DUMMY_TESTIMONIALS = [
  { name: "Ahmet Y.", role: "Firma Sahibi", comment: "HÄ±zlÄ± ve profesyonel Ã§Ã¶zÃ¼m." },
  { name: "AyÅŸe K.", role: "MÃ¼dÃ¼r", comment: "Beklentimizin Ã¼zerinde bir iÅŸ." },
  { name: "Mehmet D.", role: "GiriÅŸimci", comment: "Kesinlikle tavsiye ederim." }
];

const DUMMY_FAQ = [
  { question: "SÃ¼reÃ§ ne kadar sÃ¼rer?", answer: "Proje kapsamÄ±na gÃ¶re en hÄ±zlÄ± sÃ¼rede teslim ediyoruz." },
  { question: "Fiyatlar nasÄ±l?", answer: "BÃ¼tÃ§e dostu ve ÅŸeffaf fiyatlandÄ±rma sunuyoruz." },
  { question: "Destek var mÄ±?", answer: "Evet, 7/24 teknik destek saÄŸlÄ±yoruz." }
];

// --- GÃœVENLÄ°K VE MANTIK KONTROLLERÄ° ---
const rawConfig = siteConfig || {};
const metadata = rawConfig.metadata || { title: "Web Siteniz", description: "Kurumsal Ã‡Ã¶zÃ¼mler" };
const content = rawConfig.content || {};

// 1. Hero & About
const hero = content.hero || { headline: "HoÅŸ Geldiniz", subheadline: "Profesyonel Ã‡Ã¶zÃ¼mler", ctaButtonText: "Ä°letiÅŸim" };
const about = content.about || { title: "HakkÄ±mÄ±zda", description: "Biz kimiz...", stats: [] };

// 2. Ä°letiÅŸim & Harita (HARÄ°TA SORUNU Ã‡Ã–ZÃœMÃœ)
const rawContact = content.contact || {};
const contact = {
  address: rawContact.address || "TÃ¼rkiye",
  phone: rawContact.phone || "+90 555 000 0000",
  email: rawContact.email || "info@example.com",
  // Harita sorgusu yoksa, adresi veya varsayÄ±lan olarak 'Istanbul'u kullan
  map_query: rawContact.map_query || rawContact.address || "Istanbul, Turkey"
};

// 3. GÃ¶rsel Keywordler
const images = rawConfig.images || {};
const heroKeyword = images.hero_keyword || "technology";
const aboutKeyword = images.about_keyword || "office";
const featureKeywords = images.feature_keywords || ["code", "design", "marketing"];

// 4. Liste Kontrolleri ve SÃœREÃ‡ DÃœZENLEMESÄ° (SÄ°METRÄ° AYARI)
const services = (content.services && content.services.length > 0) ? content.services : DUMMY_SERVICES;
const testimonials = (content.testimonials && content.testimonials.length > 0) ? content.testimonials : DUMMY_TESTIMONIALS;
const faq = (content.faq && content.faq.length > 0) ? content.faq : DUMMY_FAQ;

// Process (SÃ¼reÃ§) Listesi MantÄ±ÄŸÄ±:
// EÄŸer liste boÅŸsa -> Dummy kullan.
// EÄŸer 4 veya 5 tane gelirse -> Ä°lk 3 tanesini al (Simetri bozulmasÄ±n).
// EÄŸer 6'dan fazla gelirse -> Ä°lk 6 tanesini al.
let rawProcess = (content.process && content.process.length > 0) ? content.process : DUMMY_PROCESS;

if (rawProcess.length === 4 || rawProcess.length === 5) {
  rawProcess = rawProcess.slice(0, 3);
} else if (rawProcess.length > 6) {
  rawProcess = rawProcess.slice(0, 6);
}
const process = rawProcess;

---

<Layout title={metadata.title} description={metadata.description}>
  <Navbar title={metadata.title} />
  
  <HeroSection 
    headline={hero.headline}
    subheadline={hero.subheadline}
    ctaButtonText={hero.ctaButtonText}
    imageKeyword={heroKeyword}
  />
  
  <AboutSection 
    title={about.title}
    description={about.description}
    stats={about.stats}
    imageKeyword={aboutKeyword}
  />

  <ServicesSection 
    services={services} 
    featureKeywords={featureKeywords}
  />

  <ProcessSection steps={process} />
  
  <TestimonialsSection testimonials={testimonials} />
  
  <FAQSection faqs={faq} />
  
  <ContactSection contact={contact} />
  
  <Footer 
    title={metadata.title}
    description={about.description}
    contact={contact}
  />
</Layout>